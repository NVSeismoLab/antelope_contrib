.TH ORBLOOK 1 "$Date$"
.SH NAME
orblook \- controls caching of orblookup web page data
.SH SYNOPSIS
.nf
orblook \fBstart\fP \fIorbname interval\fP
orblook \fBstop\fP  \fIorbname \fP
orblook \fBrestart\fP \fIorbname interval\fP
.fi
.SH DESCRIPTION
\fBorblook\fP controls the caching of orb packet source data for the orblookup cgi
program.
.LP 
Orblook can start, stop, or restart the process retrieving data for 
a particular orb.  This data is stored in a parameter file in human-readable 
format. 
.LP
\fBorblookup\fP is a cgi program that outputs this data in html format.  When placed 
in the web tree and given executable permissions by the web server, 
orblookup can be navigated to and its output can be viewed in a web browser.  
Data from this page is updated on a regular interval, so the viewer's web 
browser will automatically refresh with the newest data available to it.

.SH OPTIONS
.IP "start \fIorbname\fP \fIinterval\fP"
Starts retrieving data for orb \fIorbname\fP every \fIinterval\fP minutes and
caching it in the temporary cache files.  For orbs containing large
amounts of data, and for small intervals, it may take longer to complete retrieval and analysis than the interval given;  in these cases, the new retrieval will
not start until the current retrieval is complete.
.IP "stop \fIorbname\fP"
Stops the retrieval of data for orb \fIorbname.\fP
.IP "restart \fIorbname\fP \fIinterval\fP"
Stops, and then starts, retrieval of data for the orb \fIorbname\fP every
\fIinterval\fP minutes.

.SH FILES
/tmp/cache_\fIorbname\fP
.br
Contains the cached packet data grabbed from orb \fIorbname.\fP  This location
is a default and may be different on your system.  This should not ever be 
edited by the end user except in cases of catastrophic failure, in which case 
it can be simply deleted.  Deleting will cause the orblookup cgi program to 
generate an error page when viewed until the cache is regenerated by orblook.
.SH PARAMETER FILE

.TP
orblookup.pf
Two items of importance exist in the orblookup configuration file: the orblist,
and the html template.
.TP
The orb list
.br
The first item of importance in the orblookup configuration file is the list
of orbs to be monitored, containing the orb names, packet types to be
scanned, the alert messages to be used, the fields to be displayed, and fields
to be ignored for particular packet types.
.TP
The HTML Template
.br
The template element contains blocks of valid html code with special comments 
designed to act as placeholders for variables.  At least one block of code 
must be contained by html_template: the overview element.  This is the first 
block of code processed, and if no references to other blocks are contained 
with it, may be the only block of code processed.
.LP
The orblookup program steps through the overview string literal and substitutes 
generated code at special comments encountered.  There are three specific       
comment types used by orblookup, with the following format:  
.LP
.IP "<!-- ?var_name -->"
.br
which is replaced by the value of the given variable, where var_name 
is a legal variable name listed below:
.LP
.nf
orbname            the name of the current orb
minnetlat          the smallest latency on the current network
mediannetlat       the median latency on the current network          
maxnetlat          the largest latencies seen on the current network
alertmode          " checked" if displaying only alerts, "" otherwise
staclass           class corresponding for current station
netclass           class corresponding to current network
time               the time in UTC of the last cache
encodednet         the network in scope in url-encoded form
encodednetsta      the sta+network in url-encoded form
alert_class        class corresponding to the current alert state
alert_desc         full description of the alert state
rownumclass        an alternating class name, either .oddrow or .evenrow
fieldclass         the class of the current field
fieldvalue         the value of the current field
fieldalign         the alignment of the current field, based on config
checkedstatus      replaced by "checked" or nothing depending on field
scriptname         the url of the current page
percentcolwidth    the reciprocal of the number of columns as a percent
net                name of the network currently in scope
sta                name of the station currently in scope
used_field         the name of the current field that is enabled
all_field          the name of the current field
num_used_fields    # of fields current enabled
numfields          total # of fields defined for a network
num_nets           total # of networks used
numstas            total # of stations on current network
numstastot         total # of stations on all networks
numstas_expected   total # of expected stations on current network    
numchans           # of channels found for the current station
numchanstot        total # of channels on current network
url                url for the current network
orburl             url for the current orb
orb                name of the current orb
.fi
.IP "<!-- ?insert block_name iterate=num indent=nspaces -->"
.br
which is replaced by a block of code contained in block_name and is 
indented nspaces, where block_name is a top-level component under
html_template.  This performes num iterations of the block of code.
.IP "<!-- ?insert block_name iterate=var_name indent=nspaces -->"
.br
which is replaced by a block of code iterated over var_name and
indented nspaces, where var_name is a legal variable name listed
below, and has an integer value.  This loops over the variable
var_name, and updates its value through each iteration.  The valid
variable names for this purpose are:
.LP
.IP
      net
      sta
      used_field
      all_field
      alert_stage
      orb
.SH EXAMPLE
% orblook start igpprt:anza
.br
Starting orb igpprt:anza at an interval of 6
.PP
% orblook stop igpprt:anza
.br
orblook on igpprt:anza stopped.
.PP
% orblook restart igpprt:anza 36
.br
orblook on igpprt:anza stopped.
Restarting orb igpprt:anza at an interval of 36

.SH RETURN VALUES
orblook returns 0 for normal execution and -1 if the command can't be carried 
out, accompanied by an error message describing the reason for the command 
failure.
.SH "SEE ALSO"
.nf
orbstat(1)
orblookup(1)
.fi
.SH AUTHOR
.nf
Jennifer Bowen
.br
Institute of Geophysics and Planetary Physics
.br
Scripps Institution of Oceanography

.fi
.\" $Id$
